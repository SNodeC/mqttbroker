{
  "discover_prefix": "iotempower",
  "mappings": {
    "topic_level": [
      {
        "name": "test01",
        "topic_level": [
          {
            "name": "button1",
            "subscription": {
              "type": "binary_sensor",
              "qos": 2,
              "retain_message": false,
              "static": {
                "mapped_topic": "mapping/value",
                "message_mappings": [
                  {
                    "message": "pressed",
                    "mapped_message": "on"
                  },
                  {
                    "message": "released",
                    "mapped_message": "off"
                  }
                ]
              }
            }
          }
        ]
      }, {
        "name": "mapping",
        "topic_level": [
          {
            "name": "value",
            "subscription": {
              "value": {
                "mapped_topic": "mapping/json",
                "mapping_template": "{\"state\":\"{{value}}\"}",
                "mapping_template_also_works": "{% if value == \"on\" %}{\"state\": \"on\"}{% else if value == \"off\" %}{\"state\": \"off\"}{% endif %}"
              }
            }
          },
          {
            "name": "json",
            "subscription": {
              "qos": 0,
              "json": {
                "mapped_topic": "test02/onboard/set",
                "mapping_template": "{% if json.state == \"on\" %}on{% else if json.state == \"off\" %}off{% endif %}",
                "retain_message": false
              }
            }
          }
        ]
      }
    ]
  }
}
